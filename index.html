
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Language Archive Collector — Tripod: Meaning‑Based AI‑Assisted OBT</title>

  <!-- Montserrat font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
  <!-- Masthead -->
  <div id="masthead" role="banner" aria-label="App title">
    <div class="masthead-inner">
      <img src="assets/logo-shema-white.png" alt="Shema logo" class="logo" />
      <div class="titles">
        <h1 class="app-title">Language Archive Collector</h1>
        <p class="app-subtitle">Tripod: Meaning‑Based AI‑Assisted OBT</p>
      </div>
    </div>
  </div>

  <!-- Sticky header: totals + actions -->
  <header id="app-header" role="toolbar" aria-label="Primary controls">
    <div class="header-inner">
      <div class="meta-block">
        <div class="clock-wrap">
          <span id="totalHours" class="clock">0h 00m</span>
          <span class="goal">/ 100h goal</span>
        </div>
        <div class="progress">
          <div id="progressFill" class="progress-fill" style="width:0%"></div>
        </div>
      </div>
      <div class="header-actions">
        <button id="newEntryBtn" class="btn primary">New Entry</button>
        <button id="saveEntryBtn" class="btn outline">Save Entry</button>
      </div>
    </div>
  </header>

  <!-- Section toolbar -->
  <div id="section-toolbar" role="region" aria-label="Section utilities">
    <div class="toolbar-inner">
      <div class="search-group">
        <input id="searchInput" type="search" placeholder="Search entries, tags, notes…" aria-label="Search" />
        <button id="clearSearchBtn" class="btn subtle" title="Clear search">Clear</button>
      </div>
      <div class="section-toggles">
        <button id="expandAllBtn" class="btn subtle">Expand all</button>
        <button id="collapseAllBtn" class="btn subtle">Collapse all</button>
      </div>
    </div>
  </div>

  <!-- Main content -->
  <main id="content">
    <!-- 1) Ideas & Themes (collapsed by default) -->
    <section class="pane" data-pane="ideas">
      <button class="pane-head" aria-expanded="false">
        <span>1) Ideas &amp; Themes</span><span class="chev">▸</span>
      </button>
      <div class="pane-body" style="display:none">
        <div class="ideas-grid">
          <aside class="genres">
            <h3>Genres (with hours)</h3>
            <ul id="genreList" class="genre-list" aria-live="polite"></ul>
          </aside>
          <div class="ideas-content">
            <div class="field-row">
              <label for="genreSelect">Select genre</label>
              <select id="genreSelect"></select>
            </div>
            <div class="field-row">
              <label for="promptSelect">Pick an idea / prompt</label>
              <select id="promptSelect"></select>
            </div>
            <button id="startWithPromptBtn" class="btn primary">Start with this prompt → Audio Capture</button>
          </div>
        </div>
      </div>
    </section>

    <!-- 2) Audio Capture (collapsed by default) -->
    <section class="pane" data-pane="audio">
      <button class="pane-head" aria-expanded="false">
        <span>2) Audio Capture</span><span class="chev">▸</span>
      </button>
      <div class="pane-body" style="display:none">
        <div class="audio-controls">
          <button id="recordBtn" class="btn primary">Record</button>
          <button id="pauseBtn" class="btn">Pause</button>
          <button id="resumeBtn" class="btn">Resume</button>
          <button id="stopBtn" class="btn danger">Stop</button>

          <input id="audioTitle" class="input" placeholder="Clip title (optional)" />
          <a id="downloadClip" class="btn outline" download="clip.webm" aria-disabled="true">Download</a>
          <button id="saveAudioIdBtn" class="btn outline">Save audio &amp; create Entry ID</button>

          <span id="recStatus" class="rec-status" aria-live="polite">Idle</span>
          <button id="uploadBtn" class="btn outline" type="button">Upload audio</button>
          <input id="uploadAudio" type="file" accept="audio/*" hidden />
        </div>

        <canvas id="waveform" height="84" aria-label="Waveform"></canvas>

        <div class="trim-controls">
          <label>Trim from (sec)
            <input id="trimStart" type="number" min="0" step="0.1" value="0">
          </label>
          <label>to (sec)
            <input id="trimEnd" type="number" min="0" step="0.1" value="0">
          </label>
          <button id="applyTrimBtn" class="btn">Apply trim</button>
        </div>

        <audio id="player" controls></audio>
      </div>
    </section>

    <!-- 3) Entry / Language Metadata (collapsed by default) -->
    <section class="pane" data-pane="meta">
      <button class="pane-head" aria-expanded="false">
        <span>3) Entry &amp; Language Metadata</span><span class="chev">▸</span>
      </button>
      <div class="pane-body" style="display:none">
        <div class="grid-3">
          <div class="field">
            <label for="entryId">Entry ID</label>
            <input id="entryId" placeholder="Will be auto‑generated when you save audio" />
          </div>
          <div class="field">
            <label for="languageName">Language name</label>
            <input id="languageName" placeholder="Name" />
          </div>
          <div class="field">
            <label for="languageCode">Language code</label>
            <input id="languageCode" placeholder="ISO / internal code" />
          </div>
          <div class="field">
            <label for="dialect">Dialect</label>
            <input id="dialect" placeholder="Dialect or Where the speaker grew up" />
          </div>
          <div class="field">
            <label for="styleSelect">Style</label>
            <select id="styleSelect">
              <option value="">Choose style…</option>
              <option>Conversational</option>
              <option>Ceremonial / Formal</option>
              <option>Teaching / Instruction</option>
              <option>Legal / Statute</option>
              <option>Religious / Worship</option>
              <option>Narrative storytelling</option>
              <option>Dialogue‑heavy</option>
              <option>Poetic</option>
              <option>Lament</option>
              <option>Praise / Hymn</option>
              <option>Proverb / Wisdom</option>
              <option>Other</option>
            </select>
          </div>
          <div class="field">
            <label for="genreMeta">Genre</label>
            <select id="genreMeta"></select>
          </div>
          <div class="field">
            <label for="registerSelect">Register</label>
            <select id="registerSelect">
              <option value="">Choose register…</option>
              <option>Casual conversation</option>
              <option>Ceremonial / formal</option>
              <option>Teaching / instructional</option>
              <option>Legal / formal</option>
              <option>Religious / worship</option>
              <option>Narrative storytelling</option>
              <option>Dialogue‑rich</option>
              <option>Poetic</option>
              <option>Other</option>
            </select>
          </div>
          <div class="field">
            <label for="settingSelect">Setting (where the story was told)</label>
            <select id="settingSelect">
              <option value="">Choose setting…</option>
              <option>Home</option>
              <option>Workplace</option>
              <option>Market / Village square</option>
              <option>Temple / Church</option>
              <option>School</option>
              <option>Field / Forest</option>
              <option>Waterfront / Shore</option>
              <option>Road / Travel</option>
              <option>Ceremony / Event</option>
              <option>Other</option>
            </select>
          </div>
          <div class="field">
            <label for="audienceSelect">Audience</label>
            <select id="audienceSelect">
              <option value="">Choose audience…</option>
              <option>Individual</option>
              <option>Family</option>
              <option>Children</option>
              <option>Elders</option>
              <option>Community</option>
              <option>Leaders</option>
              <option>Mixed group</option>
              <option>Other</option>
            </select>
          </div>
          <div class="field">
            <label for="dateField">Date</label>
            <input id="dateField" type="date" />
          </div>
        </div>
      </div>
    </section>

    <!-- 4+5 in a flex grid; only these can stay open together -->
    <div class="pane-flex">
      <section class="pane" data-pane="transcript">
        <button class="pane-head" aria-expanded="false">
          <span>4) Transcription</span><span class="chev">▸</span>
        </button>
        <div class="pane-body" style="display:none">
          <div class="callout">
            <strong>Tagging now happens in the Assistant.</strong>
            <ol>
              <li>Transcribe the audio here.</li>
              <li>Click <em>Copy transcript</em>.</li>
              <li>Open the Assistant and paste the text: 
                <a class="link" href="https://chatgpt.com/g/g-68d1d55b7af881919b7fd7f98a062e56-language-archive-tagger" target="_blank" rel="noopener">
                Language Archive Tagger</a>.
              </li>
            </ol>
          </div>
          <textarea id="transcript" rows="10" placeholder="Type the transcript here."></textarea>
          <div class="field-row">
            <button id="copyTranscriptBtn" class="btn outline">Copy transcript</button>
            <a class="btn primary" target="_blank" rel="noopener" href="https://chatgpt.com/g/g-68d1d55b7af881919b7fd7f98a062e56-language-archive-tagger">Open Tagger Assistant</a>
          </div>
          <div class="field-row">
            <label for="notes">Notes</label>
            <input id="notes" placeholder="Reviewer notes (optional)" />
          </div>
          <div class="export-row">
            <button id="exportJsonBtn" class="btn outline">Export Entry (JSON)</button>
            <button id="exportCsvBtn" class="btn outline">Export Transcript (CSV)</button>
            <button id="importJsonBtn" class="btn">Import Entry (JSON)</button>
          </div>
        </div>
      </section>

      <section class="pane" data-pane="audioSide">
        <button class="pane-head" aria-expanded="false">
          <span>5) Audio</span><span class="chev">▸</span>
        </button>
        <div class="pane-body" style="display:none">
          <p class="muted">Use this mini player to listen while transcribing.</p>
          <audio id="playerSide" controls></audio>
          <div class="tiny-gap"></div>
          <canvas id="waveformSide" height="64" aria-label="Waveform (side)"></canvas>
        </div>
      </section>
    </div>

  </main>

  <!-- Footer -->
  <footer id="app-footer" role="contentinfo">
    <div class="footer-inner">
      <div class="footer-actions">
        <button id="themeToggle" class="btn">Dark / Light</button>
        <button id="clearFormBtn" class="btn danger">Clear Form</button>
      </div>
      <div class="org">© 2025 Shema Bible Translation, University of the Nations. YWAM Kansas City.</div>
    </div>
  </footer>

  <!-- Defer ensures DOM is parsed before JS runs on GitHub Pages -->
  <script src="./app.js" defer></script>
</body>
</html>
